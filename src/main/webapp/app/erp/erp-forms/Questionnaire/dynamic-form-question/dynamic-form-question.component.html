<!--

    Erp System - Mark III No 3 (Caleb Series) Client 0.2.0-SNAPSHOT
    Copyright Â© 2021 - 2022 Edwin Njeru (mailnjeru@gmail.com)

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see <http://www.gnu.org/licenses/>.

-->
<div [formGroup]="form">

  <ng-template #formTmpl
               let-index="index">
    <label [attr.for]="questionId(index)">{{ questionLabel(index) }}</label>

    <div [ngSwitch]="question.controlType">

      <!--// TODO Create several API with type field-->
      <!--<input *ngSwitchCase="'textbox'"
             [formControl]="questionControl(index)"
             [placeholder]="question.placeholder"
             [attr.min]="question['min']"
             [attr.max]="question['max']"
             [attr.pattern]="question['pattern']"
             [id]="questionId(index)"
             [type]="question['type']">-->

      <!--// TODO Implement options component-->
      <!--<select [id]="question.key"
              *ngSwitchCase="'dropdown'"
              [formControl]="questionControl(index)">
        <option value=""
                disabled
                *ngIf="!!question.placeholder"
                selected>{{ question.placeholder }}</option>
        <option *ngFor="let opt of question['options']"
                [value]="opt.key">{{ opt.value }}</option>
      </select>-->

      <!--//TODO Implement text-area component-->
      <!--<textarea *ngSwitchCase="'textarea'"
                [formControl]="questionControl(index)"
                [id]="question.key"
                [cols]="question['cols']"
                [rows]="question['rows']"
                [maxlength]="question['maxlength']"
                [minlength]="question['minlength']"
                [placeholder]="question.placeholder"></textarea>-->
    </div>

    <div class="errorMessage"
         *ngIf="!isValid">{{ question.label }} is required</div>

  </ng-template>

  <div *ngIf="question.iterable; else formTmpl">
    <div *ngFor="let field of questionArray.controls; let i=index; first as isFirst last as isLast">
      <ng-container [ngTemplateOutlet]="formTmpl"
                    [ngTemplateOutletContext]="{index: i}"></ng-container>

      <button *ngIf="question.iterable && questionArray.controls.length > 1"
              (click)="removeQuestion(i)"
              type="button">-</button>

      <button *ngIf="question.iterable && isLast"
              (click)="addQuestion()"
              type="button">+</button>

    </div>
  </div>

</div>
